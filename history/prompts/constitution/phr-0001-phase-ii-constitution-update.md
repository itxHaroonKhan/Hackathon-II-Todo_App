---
id: PHR-0001
title: Phase II Constitution Update
stage: constitution
date: 2026-01-03
surface: agent
model: claude-sonnet-4-5-20250929
feature: none
branch: master
user: itxHaroonKhan
command: /sp.phr
labels: ["constitution", "architecture", "full-stack", "nextjs", "fastapi", "database"]
links:
  spec: null
  ticket: null
  adr: null
  pr: null
files:
 - .specify/memory/constitution.md
tests:
 - none
---

## Prompt

Phase II ‚Äî Full-Stack Web Todo Application

Project: The Evolution of Todo ‚Äî Phase II (Full-Stack Web Application)

Objective:
Evolve the Phase I in-memory console Todo app into a production-style full-stack web application using a strict API-first architecture with real database persistence.

System Architecture (NON-NEGOTIABLE):
- Frontend: Next.js
- Backend: FastAPI
- ORM: SQLModel
- Database: Neon (PostgreSQL)
- Communication: REST API (JSON)

Core Principles:
- Backend is the single source of truth
- Frontend is stateless and dumb (UI + API calls only)
- Business logic lives ONLY in backend
- Database schema stability over rapid change
- Explicitness over magic
- Production realism over tutorial shortcuts

Scope Definition:
This phase focuses on transforming local logic into a real-world web system with proper separation of concerns.

In Scope:
- RESTful API design with FastAPI
- Persistent storage using SQLModel + PostgreSQL (Neon)
- CRUD operations for Todo tasks
- Next.js frontend consuming backend APIs
- Environment-based configuration (.env)
- Clean project structure (frontend / backend separation)

Out of Scope (STRICT):
- AI features or chatbots
- Authentication / authorization
- File uploads
- Background jobs
- WebSockets
- Kafka, Dapr, or distributed systems
- Kubernetes or Docker (reserved for later phases)
- Testing frameworks (manual testing only)

Data Model Authority:
- Task model must be explicitly defined and frozen early
- Minimum required fields:
  - id (primary key)
  - title (required)
  - description (optional)
  - is_completed (boolean)
  - created_at (timestamp)
- Schema changes require explicit justification

API Design Rules:
- REST endpoints must be explicit and predictable
- No hidden behavior
- No overloaded endpoints
- Validation handled via Pydantic / SQLModel
- Proper HTTP status codes required

Code Quality Standards:
- No autogenerated CRUD scaffolding without review
- Readable, maintainable code
- Meaningful naming conventions
- No unused code or imports
- Clear separation:
  - routes
  - models
  - database/session
  - services (if needed)

Development Discipline:
- Spec-driven development using Spec-Kit
- Workflow:
  Constitution ‚Üí Specify ‚Üí Plan ‚Üí Task ‚Üí Implement
- No manual coding outside agent instructions
- Each change must be traceable to a spec

Persistence Rules:
- All data must persist in Neon DB
- No in-memory fallback
- No SQLite for production logic
- Database URL must be environment-driven

Frontend Discipline:
- Next.js handles rendering and user interaction only
- No business rules in frontend
- All state synced from backend APIs
- Error and loading states must be explicit

Success Criteria:
- Full CRUD works end-to-end via web UI
- Data persists across server restarts
- Frontend and backend are cleanly decoupled
- Codebase is extendable for Phase III (AI integration)
- Project passes architectural review without rewrites

Failure Conditions:
- Business logic in frontend
- Skipping database layer
- Tight coupling between frontend and backend
- Scope creep beyond Phase II
- Ignoring spec-driven workflow

Authority Order:
1. This Constitution
2. Phase II /sp.specify
3. Phase II /sp.plan
4. Phase II /sp.task
5. Phase II /sp.implement

Any conflict must be resolved by following this order.

## Response snapshot

Updated the project constitution from version 1.0.0 to 2.0.0, transforming it from a Phase I in-memory console application constitution to a Phase II full-stack web application constitution with new architectural principles.

## Outcome

- ‚úÖ Impact: Updated constitution to reflect Phase II architecture (Next.js + FastAPI + SQLModel + Neon DB)
- üß™ Tests: none
- üìÅ Files: .specify/memory/constitution.md
- üîÅ Next prompts: /sp.specify to create Phase II feature specification
- üß† Reflection: Major architectural shift requires fundamental changes to project governance principles

## Evaluation notes (flywheel)

- Failure modes observed: Script .specify/scripts/bash/create-phr.sh not found, had to create PHR manually
- Graders run and results (PASS/FAIL): N/A
- Prompt variant (if applicable): N/A
- Next experiment (smallest change to try): Create the missing PHR creation script for future use